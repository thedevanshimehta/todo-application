<!DOCTYPE html>
<html>
<head>
 <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <title>TO-DO</title>
</head>
<style>
 body {
      background: linear-gradient(to right, rgb(255, 214, 197), #f8c8dc);
      min-height: 100vh;
    }
 
.add-task{
     display: flex;
     flex-grow:1;
    margin-left:auto;
    margin-right:auto;
    max-width:600px;
    margin-top:70px;
}
.app-card {
      border-radius: 18px;
      margin-top:100px;
    }
.scroll{
    overflow: scroll;
    scrollbar-width:none;
}    

.item-card{
    background-color: #FFEFF1;
    border:1px;
    padding : 15px 20px;
    border-radius: 10px;
    max-width: 600px;
    margin-top: 10px;
    margin-bottom: 10px;
    display:flex;
}

    .custom-todo-list {
  list-style: circle !important; 
             
}

.custom-todo-list li {
  list-style: circle;
  display: flex;
  justify-content: space-between; 
  align-items: flex-start;  
  width:100%;     
 
}


.custom-todo-list li span {
  flex: 1;   
  margin-right: 12px;                     
  word-break: break-word;         
}

.btn-pink {
      background-color: #ff9a8a;
      margin-left: 10px;
      color: white;
      border: none;
    }

.btn-pink:hover {
      background-color: #ff7f6a;
      color: white;
    }

.task-complete{
        white-space:nowrap;
        margin-left: 6px;
    }

.task-text.completed {
      text-decoration: line-through;
      color: #6c757d;
    }

</style>
<body>
  
  <div class="js-container"></div>

  <script src="https://unpkg.com/supersimpledev/react.js"></script>
  <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
  <script src="https://unpkg.com/supersimpledev/dayjs.js"></script>
  <script src="https://unpkg.com/supersimpledev/babel.js"></script>
  <script type="text/babel">

function ToDoForm({taskLists,setTaskLists}){
    const [inputText,setInputText]=React.useState('');
     
    function handleKeyDown(event){
        if(event.key=='Enter'){
            clickInput();
        }
    }

    function setNewInput(event){
         setInputText(event.target.value);
        }
        function clickInput(){
        const newTask=[
            ...taskLists,{
                tasks:inputText,
                status:"Incomplete",
                id:crypto.randomUUID()
            }
        ];
        if(inputText!="" && inputText!=" "){
            setTaskLists(newTask);
        }
        setInputText('');
    }
    return(
        <div className="add-task">
            <input className="form-control" type="text" value={inputText} placeholder="Add a new task" onChange={setNewInput} onKeyDown={handleKeyDown}/>
            <button className="btn btn-pink" onClick={clickInput}>Add</button>
       </div>

    );
}

function ToDoList({tasks,status,id,statusMarked,statusDeleted,taskEdit}){
    const [edit,setEdit]=React.useState(false);
    const [string,setString]=React.useState(tasks);
    function markTask(){
       statusMarked(id);
    }

    function deleteTask(){
        statusDeleted(id);
    }

    function editTask(){
         setEdit(true);
    }

    function saveTask(){
           taskEdit(id,string);
           setEdit(false);
    }
        return(
            <div className="item-card">
  <li className="custom-todo-list li">
    {status === "Incomplete" ? (
      edit === true ? (<input type="text"value={string}onChange={(e) => setString(e.target.value)}className="form-control" style={{ display: "inline-block", width: "60%" }}/>) : (
        <span className="custom-todo-list li span">{tasks}</span>)) : (<span className="custom-todo-list li span"><del style={{ color: "grey" }}>{tasks}</del>
      </span>
    )}<button 
      className="btn btn-sm btn-outline-success task-complete"  
      onClick={markTask}
    >
      Mark as Completed
    </button>

    {status === "Incomplete" && (
      edit === false ? (
        <button 
          className="btn btn-sm btn-outline-primary task-complete"  
          onClick={editTask}
        >
          Edit
        </button>
      ) : (
        <button 
          className="btn btn-sm btn-outline-primary task-complete"  
          onClick={saveTask}
        >
          Save
        </button>
      )
    )}

    <button 
      className="btn btn-sm btn-outline-danger task-complete" 
      onClick={deleteTask}
    >
      Delete
    </button>
  </li>
</div>

    );
}

function TaskLists({taskLists,statusMarked,statusDeleted,taskEdit}){
    return(
//<ul/> here because we are making unordered list only one. <li> is for contents inside it. everytime, todolist gets called, new list is made. Here, unordered list will be the same, just looping occurs
    <div className="card shadow-sm app-card mx-auto " style={{ maxWidth: "600px" }}>
        <div className="card-body scroll" >
            <h4 className="text-center mb-4">My To-Do List</h4>
       <ul className="list-group custom-todo-list">
            {taskLists.map((taskList)=>{
                return(
                    <ToDoList
                    tasks={taskList.tasks}
                    status={taskList.status}
                    id={taskList.id}
                    key={taskList.id}
                    statusMarked={statusMarked}
                    statusDeleted={statusDeleted}
                    taskEdit={taskEdit}
                    />
                );
            })}
            </ul>
      </div>
      </div>
   
    );
}

function ToDoApp(){
    const [taskLists,setTaskLists]=React.useState([]);

    function statusMarked(id){
        const newArray=
                taskLists.map((taskList)=>{
                        if(taskList.id===id){
                             return{
                                ...taskList,status:"Complete"
                        } 
                    }
                return taskList;
                });
        setTaskLists(newArray);
           
    }

    function statusDeleted(id){
        const newArray=
                taskLists.filter((taskList)=>(taskList.id!=id));
        setTaskLists(newArray);
           
    }

    function taskEdit(id,newInputText){
        const newArray=
                taskLists.map((taskList)=>{
                        if(taskList.id===id){
                             return{
                                ...taskList,tasks:newInputText
                        } 
                    }
                return taskList;
                });
        setTaskLists(newArray);
           
    }
  
    return(
        <>
        <ToDoForm taskLists={taskLists} setTaskLists={setTaskLists}/>
        <TaskLists taskLists={taskLists} statusMarked={statusMarked} statusDeleted={statusDeleted} taskEdit={taskEdit}/>
      
        </>
    )
}

const container = document.querySelector('.js-container');
    ReactDOM.createRoot(container).render(<ToDoApp/>);
  </script>
</body>

</html>